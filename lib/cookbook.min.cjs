"use strict";const{load:e}=require("cheerio"),{fetch}=require("undici"),headers={Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8","Accept-Encoding":"gzip, deflate, br","Accept-Language":"pt-BR,pt;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"no-cache",Connection:"keep-alive",Cookie:"",DNT:"1",Pragma:"no-cache","Upgrade-Insecure-Requests":"1","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3"},kHeaders=Symbol("headers");async function getRecipe(t){let r=await fetch(`https://www.tudoreceitas.com/pesquisa?q=${encodeURIComponent(t)}`,{headers}).then(e=>e.text()),i=e(r,{lowerCaseTags:!0},!0);return i('div[data-js-selector="resultados"] .resultado.link > a').first().attr("href")}async function getRecipeInfo(t,r={},i=new Date().getTime()){if("string"!=typeof t)throw TypeError('The parameter "query" must be a string, received: '+typeof t);if("object"!=typeof r)throw TypeError('The "options" parameter must be an object, received: '+typeof r);r=Object.assign({format:!0},r);let a=/^(https?|http):\/\/www\.tudoreceitas\.com\/[\w\-]+\.html$/.test(t)?t:await getRecipe(t),n=await fetch(a,{headers}).then(e=>e.text()).catch(()=>""),o=e(n,{lowerCaseTags:!0},!0),[s,...c]=o(".imagen_wrap source").map((e,t)=>o(t).attr("srcset").trim()).toArray(),[p,l,d]=o(".votos").text().match(/:\s+(\d+)\s+\((\d+)/)||[],m=o(".post-categoria-link"),h=o("div .autor"),u={title:o("title").text().trim(),description:o('meta[name="description"]').attr("content"),imageUrl:s||"",category:{name:m.text(),link:m.attr("href")},url:a,author:{name:h.find(".nombre_autor a").text(),avatarUrl:h.find("source").attr("srcset").trim()||""},published_at:o(".date_publish").text(),review:{stars:parseFloat(l||0),votes:parseFloat(d||0)},comments:[],duration:o(".property.duracion").text(),dificulty:o(".property.dificultad").text(),ingredients:o(".ingredientes .ingrediente > label").map((e,t)=>o(t).text().replace(/\s+/g," ").trim()).toArray(),instructions:[],similar:[],responseTime:new Date().getTime()-i};return r.format&&o("strong, b").each((e,t)=>o(t).replaceWith(`**${o(t).text()}**`)),o(".orden").each((e,t)=>{let r=o(t).parent().find("p").map((e,t)=>o(t).text().replace(/\s+/g," ").trim()).toArray();u.instructions.push({instruction:`${e+1}. ${r.splice(0,1)}`,imageUrl:c[e],additional:r,index:e})}),o(".relacionados .bloque.link").each((e,t)=>{let a=o(t).find("a");u.similar.push({title:a.text(),link:a.attr("href"),imageUrl:o(t).find("source").attr("srcset"),get:function(){return getRecipeInfo(this.link,r,i)},index:e})}),o('div[data-js-selector="append-comentarios"] > .comentario').each((e,t)=>{let r={author:(t=o(t)).children(".nombre").text(),date:t.children(".fecha").text(),text:t.children(".texto").text().trim(),replies:[]};for(let i of t.find(".comentario"))r.replies.push({author:(i=o(i)).find(".nombre").text(),date:i.find(".fecha").text(),text:i.find(".texto").text().trim()});u.comments.push(r)}),u}module.exports=Object.assign((async function e(){return getRecipeInfo(...arguments)}).bind(this),{Recipe:null,getRecipeInfo,getRecipe,[kHeaders]:new Map(Object.entries(headers))}),module.exports.Recipe=module.exports;